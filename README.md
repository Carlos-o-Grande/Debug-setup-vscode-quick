# Debug-setup-vscode-quick
### Setup VScode debugging (quickly)

If you never used a debugger before or never configure it on VScode, stay a while and listen.  
 *All instrutions refer to files on this repository*.   

	  
First image will guide you at starting the config process. Just click where pointed.

![1_setup](https://github.com/Carlos-o-Grande/Debug-setup-vscode-quick/blob/main/1_setup.png)

When you have done that, on VScode explorer (1st button on top left) a .vscode folder appears with a launch.json.  
*Use launch.json and tasks.json on github to guide you.*  

Files are commented where is relevant. Here they are edited for brevity.

#### launch.json
```json
"configurations": [
// this launch option runs the executable but before executes "preLaunchTask": "gcc build" (see tasks.json)
// "program": "${workspaceFolder}/" *ballons.out* can be replaced by a variable expanded on launch
// we also setup args[] to 99, this executes "ballons.out 99" setting the argv of the program
	{
		"name": "GCC & Launch",
		"type": "cppdbg",
		"request": "launch",
		"program": "${workspaceFolder}/ballons.out",
		"args": [
			"99",
		],
		"stopAtEntry": true,	//optional, if true debugger always stop at first instruction
		"cwd": "${fileDirname}",
		"environment": [],
		"externalConsole": false,
		"MIMode": "gdb",
		"preLaunchTask": "gcc build",	//important, corresponds to label on tasks.json
		[...omited...],
	},
// this launch option runs the executable but before executes  "preLaunchTask": "Makefile" (see tasks.json)
	{
		"name": "Makefile & Launch",
		"program": "${workspaceFolder}/ballons.out",
		"args": [],
		"preLaunchTask": "Makefile",
	},
	// this launch option just executes the program
	{
		"name": "Launch (no build)",
		"program": "${workspaceFolder}/ballons.out",
		}
```

#### tasks.json
```json

"tasks": [
	// this task runs "gcc". args[] is used to setup command options.
	// in this example: gcc -fdiagnostics-color=always -g3 ${file} -o ${fileDirname}/ballons.out
	// ${file} is the active file on the editor.
	// For this example can be explicity replaced with main.c
	// the "label": "gcc build" is how launch.json identifies the task to run
	{
		"type": "cppbuild",
		"label": "gcc build",	//important
		"command": "/usr/bin/gcc",
		"args": [
			"-fdiagnostics-color=always",
			"-g3",
			"${file}",
			"-o",
			"${fileDirname}/ballons.out"
		],
		"options": {
			"cwd": "${fileDirname}"
		},
			"problemMatcher": [
			"$gcc"
		],
		"group": "build",
		"detail": "Task generated by Debugger."
	},
	// this task runs 'make debug'. see Makefile file and 'Makefile & Launch' in launch.json
	// For how to setup makefile, see end of this readme.
	{
		"type": "cppbuild",
		"label": "Makefile",	//important
		"command": "make",
		"args": [
			"debug"
		],
		"group": {
			"kind": "build",
			"isDefault": true
		},
		"detail": "run makefile"
	}
```


### Now we are ready to debug our code:


![2_debug](https://github.com/Carlos-o-Grande/Debug-setup-vscode-quick/blob/main/2_debug.png)

1. Dropdown with the options from launch.json
2. debugger toolbar (more on that below)
3. breakpoint
4. variables to watch
5. terminal for program output

Select a option from (1) and click the green play icon. VScode will compile and launch.  
> [!IMPORTANT]
> Make sure `main.c` is open and active before launching anything.

#### The debugger toolbar will appear.   
if `"stopAtEntry": true,` there will be a yellow arrow at line 27 pointing to the first instrution `int cnt = 3;`  
Otherwise it will point to first breakpoint, if there isn't one, program writes to terminal and ends.  
To setup a breakpoint click to the left of line number.  Try setting the breakpoints like in the image.  
If you want to keep track a variable click the + on box 4 and write the name.  

> [!TIP]
> If the variable is passed as a argument it will keep track across functions.  
> some common variable names like `len, i` will change when entering functions to reflect the new scope.  


### Debugger toolbar
![3_toolbar](https://github.com/Carlos-o-Grande/Debug-setup-vscode-quick/blob/main/toolbar.png)

from left to right:  
- PLAY - goes to the next breakpoint
-  STEP OVER - follow line by line but doesn't follow functions
- STEP INTO - goes inside the function if on a line that uses one
- you figure that one
- RESTART
- STOP

### Are you using a Makefile?
Should as simple as adding somewhere below `all` rule this code:
```
debug: CFLAGS += -g3
debug: re
```

That's it. Done. For new projects just copy the .vscode folder and it's contents and do some editing.  
